webpackJsonp([26],{"2lSl":function(o,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t={name:"mineCoupon",data:function(){return{couponList:[],isNoCoupon:!1,isHasCoupon:!0,goods_id:[],goods_num:[],spec_key:[],fee:[],enterSpe:"",couponId:"",orderType:""}},created:function(){this.enterSpe=this.$route.query.spe,this.couponId=this.$route.query.coupon_id,this.orderType=this.$route.query.order_type},beforeMount:function(){},mounted:function(){this.goods_id=this.$route.query.goods_id,this.goods_num=this.$route.query.goods_num,this.spec_key=this.$route.query.spec_key,this.fee=this.$route.query.fee,this.getList()},methods:{toNotUse:function(){this.$store.state.notUseCoupon=1,this.couponId=null,1==this.enterSpe&&this.$router.push({path:"/orderconfirmation",query:{spe:1,goods_id:this.goods_id,goods_num:this.goods_num,spec_key:this.spec_key,fee:this.fee,useCoupon:this.$store.state.notUseCoupon,order_type:this.orderType}}),2==this.enterSpe&&this.$router.push({path:"/orderconfirmation",query:{spe:2,goods_id:this.goods_id,goods_num:this.goods_num,spec_key:this.spec_key,useCoupon:this.$store.state.notUseCoupon,order_type:this.orderType}})},showAll:function(o){o.is_unfold=1},hideAll:function(o){o.is_unfold=0},getList:function(){var o=this;"string"==typeof o.goods_id&&(o.goods_id=o.goods_id.split(","),o.goods_num=o.goods_num.split(","),o.spec_key&&(o.spec_key=o.spec_key.split(",")),o.fee=o.fee.split(","));for(var e="",s="",t="",i="",n="",_=0;_<o.goods_id.length;_++){var p="&goods["+_+"][goods_id]="+o.goods_id[_],u="&goods["+_+"][goods_num]="+o.goods_num[_];if(o.spec_key)o.spec_key[_];else n="&goods["+_+"][spec_key]=null";e+=p,s+=u,t+=n,i+="&goods["+_+"][fee]="+o.fee[_]}var r=e+s+t+i;console.log(r,"parameter"),this.$axios({url:o.$store.state.api.coupon.coupon_canUse+r,method:"get",params:{}}).then(function(e){var s=e.data;console.log(s,"r"),0==s.error&&(o.couponList=s.data),0==o.couponList.length&&(o.isNoCoupon=!0,o.isHasCoupon=!1),0!=o.couponList.length&&(o.isNoCoupon=!1,o.isHasCoupon=!0)}).catch(function(o){})},choiceCoupon:function(o){this.$store.state.notUseCoupon=0,1==this.enterSpe&&this.$router.push({path:"/orderconfirmation",query:{spe:1,goods_id:this.goods_id,goods_num:this.goods_num,spec_key:this.spec_key,couponName:o.name,useCoupon:this.$store.state.notUseCoupon,coupon_id:o.user_coupon_id,prom_type:o.prom_type,prom_money:o.prom_money,prom_discount:o.prom_discount,order_type:this.orderType}}),2==this.enterSpe&&this.$router.push({path:"/orderconfirmation",query:{spe:2,goods_id:this.goods_id,goods_num:this.goods_num,spec_key:this.spec_key,couponName:o.name,useCoupon:this.$store.state.notUseCoupon,coupon_id:o.user_coupon_id,prom_type:o.prom_type,prom_money:o.prom_money,prom_discount:o.prom_discount,order_type:this.orderType}})}}},i={render:function(){var o=this,e=o.$createElement,t=o._self._c||e;return t("div",{staticClass:"coupon"},[t("div",{directives:[{name:"show",rawName:"v-show",value:o.isNoCoupon,expression:"isNoCoupon"}],staticClass:"no-coupon"},[t("img",{attrs:{src:s("xUTB")}})]),o._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:o.isHasCoupon,expression:"isHasCoupon"}],staticClass:"not-coupon"},[0==o.$store.state.notUseCoupon?t("i",{staticClass:"iconfont",on:{click:o.toNotUse}},[o._v("")]):o._e(),o._v(" "),1==o.$store.state.notUseCoupon?t("i",{staticClass:"iconfont",staticStyle:{color:"#ff3737"},on:{click:o.toNotUse}},[o._v("")]):o._e(),o._v(" "),t("span",[o._v("不使用优惠券")])]),o._v(" "),o._l(o.couponList,function(e){return t("div",{directives:[{name:"show",rawName:"v-show",value:o.isHasCoupon,expression:"isHasCoupon"}],staticClass:"coupon-card"},[t("div",{class:[e.user_coupon_id==o.couponId?"choice-card":"card"]},[t("div",{staticClass:"coupon-detail",on:{click:function(s){o.choiceCoupon(e)}}},[t("span"),o._v(" "),t("span"),o._v(" "),t("div",{staticClass:"coupon-title"},[t("p",[o._v(o._s(e.name))]),o._v(" "),"fixed"==e.valid_date_type?t("p",[o._v(o._s(e.valid_date_fixed_start_at)+"-"+o._s(e.valid_date_fixed_end_at))]):o._e(),o._v(" "),"danymic"==e.valid_date_type?t("p",[o._v(o._s(e.danymic_start_at)+"-"+o._s(e.danymic_end_at))]):o._e()]),o._v(" "),t("div",{staticClass:"coupon-price"},["money"==e.prom_type?t("p",[o._v("￥"+o._s(e.prom_money))]):o._e(),o._v(" "),"discount"==e.prom_type?t("p",[o._v(o._s(e.prom_discount/10)+"折")]):o._e(),o._v(" "),"money"==e.use_limit_type?t("p",[o._v("满"+o._s(e.use_limit_money)+"元可用")]):o._e(),o._v(" "),"number"==e.use_limit_type?t("p",[o._v("满"+o._s(e.use_limit_number)+"件可用")]):o._e(),o._v(" "),"none"==e.use_limit_type?t("p",[o._v(" ")]):o._e()])]),o._v(" "),t("div",{staticClass:"coupon-shop"},[t("div",{staticClass:"retract"},[t("p",["all"==e.valid_type?t("span",[o._v("全场通用")]):o._e(),o._v(" "),"goods"==e.valid_type||"except_goods"==e.valid_type?t("span",[o._v("部分商品")]):o._e(),o._v(" "),"category"==e.valid_type?t("span",[o._v("限品类")]):o._e(),o._v(" "),"category"==e.valid_type?t("span",[o._v("："+o._s(e.valid_type_name))]):o._e()]),o._v(" "),t("i",{directives:[{name:"show",rawName:"v-show",value:0==e.is_unfold,expression:"item.is_unfold == 0"}],staticClass:"iconfont no",on:{click:function(s){o.showAll(e)}}},[o._v("")]),o._v(" "),t("i",{directives:[{name:"show",rawName:"v-show",value:1==e.is_unfold,expression:"item.is_unfold == 1"}],staticClass:"iconfont yes",on:{click:function(s){o.hideAll(e)}}},[o._v("")])]),o._v(" "),1==e.is_unfold?t("p",{staticClass:"direction"},[o._v(o._s(e.content))]):o._e()])])])})],2)},staticRenderFns:[]};var n=s("VU/8")(t,i,!1,function(o){s("CpGd")},"data-v-5f2ab2d5",null);e.default=n.exports},CpGd:function(o,e){},xUTB:function(o,e,s){o.exports=s.p+"static/img/nocoupon.b1a477e.png"}});