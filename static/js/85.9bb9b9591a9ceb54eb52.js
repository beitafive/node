webpackJsonp([85],{P2pH:function(e,t){},tW5m:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("Au9i"),i={name:"bindinfo",data:function(){return{sendValue:"获取验证码",phone:"",code:"",waitTime:60,isSend:!1}},methods:{inPhone:function(){var e=new RegExp("[^\\d\\.]+$");this.phone=this.phone.replace(e,"")},inCode:function(){var e=new RegExp("[^\\d\\.]+$");this.code=this.code.replace(e,"")},isBind:function(){var e=localStorage.getItem("openid");if(!/^1[345789]\d{9}$/.test(this.phone))return Object(n.Toast)("手机号格式错误"),void(this.phone="");if(""!=this.phone){var t={type:0,openid:e,mobile:this.phone,code:this.code};this.$axios.get(this.$api.bindMobile,t).then(function(e){var t=e.data;console.log(t),0==t.code?(AUTH_TOKEN=t.token.token,localStorage.setItem("token",AUTH_TOKEN)):Object(n.Toast)(t.msg)})}else Object(n.Toast)("请填写手机号")},sendCodes:function(){var e=this,t={mobile:this.phone,scene:"BIND_MOBILE"};this.$axios.get(e.$api.getCode,t).then(function(t){var o=t.data;0==o.code?(Object(n.Toast)(o.msg),AUTH_TOKEN=o.token.token,localStorage.setItem("token",AUTH_TOKEN),e.$store.state.user.store_id=o.user.store_id,e.$store.state.user.nickname=o.user.nickname,e.$store.state.user.mobile=o.uesr.mobile):Object(n.Toast)(o.msg)})},times:function(){var e=this;if(0==e.waitTime)return document.getElementById("sendCode").style.background="#b29f74",e.sendValue="获取验证码",e.isSend=!1,void(e.waitTime=60);document.getElementById("sendCode").style.background="#ccc",e.sendValue="请等待"+e.waitTime+"s",e.waitTime--,e.isSend=!0,setTimeout(function(){e.times()},1e3)},toBind:function(){var e=this;/^1[345789]\d{9}$/.test(e.phone)?""==e.phone?Object(n.Toast)("请填写手机号"):e.$axios.post(e.$store.state.api.binding_phone,{mobile:e.phone,user_id:localStorage.user_id,code:e.code}).then(function(t){0==t.data.error&&(Object(n.Toast)("绑定成功"),e.$emit("success","")),1==t.data.error&&(Object(n.Toast)(t.data.error_msg),e.phone="",e.code="")}):(Object(n.Toast)("手机号格式错误"),e.phone="")},closeBindPhone:function(){this.$emit("closeBindPhone",!1)}}},s={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"bind-dialog",on:{touchmove:function(e){e.stopPropagation(),e.preventDefault()}}},[o("div",{staticClass:"bind-phone"},[o("p",[e._v("为保障您账号财产安全，请绑定手机号")]),e._v(" "),o("div",{staticClass:"phone"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.phone,expression:"phone"}],attrs:{type:"text",maxlength:"11",placeholder:"请输入手机号"},domProps:{value:e.phone},on:{input:[function(t){t.target.composing||(e.phone=t.target.value)},function(t){e.inPhone()}]}})]),e._v(" "),o("div",{staticClass:"code"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.code,expression:"code"}],attrs:{type:"text",maxlength:"4",placeholder:"请输入验证码"},domProps:{value:e.code},on:{input:[function(t){t.target.composing||(e.code=t.target.value)},function(t){e.inCode()}]}}),e._v(" "),o("button",{attrs:{id:"sendCode",disabled:e.isSend},on:{click:function(t){e.isBind()}}},[e._v(e._s(e.sendValue))])]),e._v(" "),o("div",{staticClass:"submit"},[o("span",{on:{click:function(t){e.closeBindPhone()}}},[e._v("取消")]),e._v(" "),o("span",{on:{click:function(t){e.toBind()}}},[e._v("确定")])])])])},staticRenderFns:[]};var a=o("VU/8")(i,s,!1,function(e){o("P2pH")},"data-v-3c6991d5",null);t.default=a.exports}});