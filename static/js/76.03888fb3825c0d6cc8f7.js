webpackJsonp([76],{Khel:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={name:"location",data:function(){return{getCity:"杭州市",searchName:"",historyList:[],bGetaddress:!1,address:"",addressInfo:{province:"",city:"",district:""},bSearch:!1,searchList:[],bSearchList:1}},beforeMount:function(){document.title=this.$route.meta.title,""==this.$store.state.comfrim_city?this.getWxAddress():this.getCity=this.$store.state.comfrim_city||"杭州市”"},mounted:function(){this.getList(),setTimeout(this.autoSearch,1200)},methods:{autoSearch:function(){document.getElementById("searchIpt").focus()},searchCity:function(){var t=this;t.$axios({method:"get",url:t.$store.state.api.address.search_city,params:{query:t.searchName}}).then(function(e){var s=e.data;t.bSearch=!0,t.bSearchList=s.error,t.searchList=s.data})},goIndex:function(t,e){this.addressInfo.province=t.province_name,this.addressInfo.city=t.city_name,this.addressInfo.district=t.district_name,this.sendLocation(),localStorage.getCity=t.city_name,localStorage.location=1,this.$router.push("/index")},clear:function(){this.$router.push("/index")},getWxAddress:function(){var t=this;wx.ready(function(){wx.getLocation({type:"wgs84",success:function(e){t.address=e,t.bGetaddress=!t.bGetaddress;e.latitude,e.longitude,e.speed,e.accuracy}})})},getAddress:function(){var t=this;t.$axios({method:"get",url:"https://restapi.amap.com/v3/geocode/regeo",params:{key:"fefae69778fa6e7bf5c5f2e0247d00ae",location:t.address.longitude+","+t.address.latitude}}).then(function(e){""!=e.data.regeocode.addressComponent.city?(t.getCity=e.data.regeocode.addressComponent.city,t.$store.state.comfrim_city=e.data.regeocode.addressComponent.city):(t.getCity=e.data.regeocode.addressComponent.province||"杭州市",t.$store.state.comfrim_city=e.data.regeocode.addressComponent.province||"杭州市"),t.addressInfo=e.data.regeocode.addressComponent,t.sendLocation()})},getList:function(){var t=this;t.$axios({method:"get",url:t.$store.state.api.address.get_history_list}).then(function(e){var s=e.data;0==s.error&&(t.historyList=s.data)})},sendLocation:function(){this.$axios({method:"get",url:this.$store.state.api.address.send_location,params:{province_name:this.addressInfo.province,city_name:this.addressInfo.city,district_name:this.addressInfo.district}}).then(function(t){})}},watch:{bGetaddress:"getAddress"}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"location"},[s("div",{staticClass:"search-ios"},[s("div",{staticClass:"input"},[s("span",{staticClass:"iconfont"},[t._v("")]),t._v(" "),s("form",{attrs:{action:"javascript:;"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchName,expression:"searchName"}],attrs:{id:"searchIpt",type:"search",placeholder:t.getCity},domProps:{value:t.searchName},on:{keyup:t.searchCity,input:function(e){e.target.composing||(t.searchName=e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"cancel",on:{click:function(e){t.clear()}}},[t._v("取消")])]),t._v(" "),t.bSearch?s("div",{staticClass:"searchList"},[1==t.bSearchList?s("p",{staticStyle:{color:"#8e8e8e"}},[t._v("没有搜索到更多")]):t._e(),t._v(" "),t._l(t.searchList,function(e,a){return 0==t.bSearchList?s("p",{key:"index",on:{click:function(s){t.goIndex(e,a)}}},[t._v(t._s(e.province_name)+","+t._s(e.city_name)+","+t._s(e.district_name))]):t._e()})],2):t._e(),t._v(" "),s("div",{staticClass:"gps"},[t._m(0),t._v(" "),s("p",{staticClass:"gps-right"},[t._v(t._s(t.getCity))])]),t._v(" "),s("div",{staticClass:"history"},[t._m(1),t._v(" "),s("ul",{staticClass:"history-address"},t._l(t.historyList,function(e,a){return s("li",{key:"index",staticClass:"two-default",on:{click:function(s){t.goIndex(e,a)}}},[t._v(t._s(e.province_name)+t._s(e.city_name)+t._s(e.district_name)+"\n            \t")])}))]),t._v(" "),t.bSearch?s("div",{staticClass:"cover"}):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"gps-left"},[e("i",{staticClass:"iconfont"},[this._v("")]),this._v(" "),e("span",[this._v("GPS定位：")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"history-tit"},[e("span",[this._v("历史访问")])])}]};var r=s("VU/8")(a,i,!1,function(t){s("rD5B")},"data-v-494c534e",null);e.default=r.exports},rD5B:function(t,e){}});