webpackJsonp([84],{"DC+l":function(a,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=t("NHPe"),r={name:"pay",data:function(){return{popupVisible:!1,ways:[{Icon:"iconfont icon-weixinzhifu",Name:"微信支付",Class:"iconfont icon-xuanze",Type:"wei"},{Icon:"iconfont icon-zhifubaozhifu",Name:"支付宝支付",Class:"iconfont icon-xuanzefou",Type:"zhi"}],waysValue:0,orderSn:"",orderId:"",space:"",is_special:"",payType:"",wxPayParams:{timeStamp:"",nonceStr:"",package:"",signType:"",paySign:""}}},created:function(){this.orderSn=this.$route.query.order_sn,this.space=this.$route.query.spe,this.payType=this.$route.query.pay_type},beforeMount:function(){document.title=this.$route.meta.title},mounted:function(){var a=Object(s.c)()?0:1;this.getWxPayParams(),this.getOrderInfo(),this.payways(a)},methods:{getOrderInfo:function(){var a=this;a.$axios.get(a.$store.state.api.order.get_order_info,{params:{order_sn:a.orderSn}}).then(function(e){var t=e.data;0==t.error&&(a.orderId=t.data.order_id,a.is_special=t.data.is_special)})},payways:function(a){for(var e in this.ways)this.ways[e].Class="iconfont icon-xuanzefou";this.ways[a].Class="iconfont icon-xuanze",this.waysValue=a},gopay:function(){var a=this.ways[this.waysValue].Type;Object(s.c)()&&("wei"==a&&this.payWx(),"zhi"==a&&this.$router.push({path:"/payzfb",query:{orderId:this.orderId,orderSn:this.orderSn,pay_type:this.payType}})),Object(s.c)()||("zhi"==a?window.location.href=window.location.origin+"/api.php?s=user/alipay/ali_pay&order_id="+this.orderId:this.$router.push({path:"/payQRcode",query:{orderSn:this.orderSn,orderId:this.orderId,pay_type:this.payType}}))},getWxPayParams:function(){var a=this;a.$axios({method:"get",url:a.$store.state.api.wx.get_wxpay_params,params:{order_sn:a.orderSn}}).then(function(e){var t=e.data;a.wxPayParams.timeStamp=t.data.timeStamp,a.wxPayParams.nonceStr=t.data.nonceStr,a.wxPayParams.package=t.data.package,a.wxPayParams.signType=t.data.signType,a.wxPayParams.paySign=t.data.paySign})},payWx:function(){var a=this;wx.chooseWXPay({timestamp:a.wxPayParams.timeStamp,nonceStr:a.wxPayParams.nonceStr,package:a.wxPayParams.package,signType:a.wxPayParams.signType,paySign:a.wxPayParams.paySign,success:function(e){1==a.is_special&&void 0==a.payType?a.$router.push({path:"/successpecialpay",query:{order_sn:a.orderSn,status:1}}):"gift"==a.payType?a.$router.push({path:"/giftpayok",query:{order_id:a.orderId}}):a.$router.push({path:"/paystatus",query:{order_sn:a.orderSn,status:1,spe:a.space}}),"商品明细"==sessionStorage.getItem("invoiceInfo")&&a.sendInvoice()}})},sendInvoice:function(){var a="",e="";"个人"==sessionStorage.getItem("is_enterprice")&&(e=1,a=sessionStorage.getItem("nameValue")),"单位"==sessionStorage.getItem("is_enterprice")&&(e=4,a=sessionStorage.getItem("firmName")),this.$axios({method:"get",url:this.$store.state.api.invoice.apply_title,params:{user_id:localStorage.user_id,order_id:this.orderId,title:a,is_enterprice:e,tax_num:sessionStorage.getItem("number")}}).then(function(a){a.data})}}},i={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"pay"},[t("div",{staticClass:"pay-ways"},a._l(a.ways,function(e,s){return t("p",{key:s,on:{click:function(e){a.payways(s)}}},[t("i",{class:e.Icon}),a._v(" "),t("span",[a._v(a._s(e.Name))]),a._v(" "),t("i",{class:e.Class})])})),a._v(" "),t("a",{staticClass:"pay-btn",attrs:{href:"javascript:;"},on:{click:function(e){a.gopay()}}},[a._v("确认支付")])])},staticRenderFns:[]};var n=t("VU/8")(r,i,!1,function(a){t("YBCH")},"data-v-3d60cf86",null);e.default=n.exports},YBCH:function(a,e){}});