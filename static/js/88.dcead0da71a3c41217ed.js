webpackJsonp([88],{"4rXH":function(t,e){},qZkl:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={name:"schoolbox",data:function(){return{visible:!1,selected:"1",nice:!1,PictrueList:[],addPicture:!0,letterN:200,localArr:[],imgs:[],express:"",storeId:"",is_public:!0,numPicture:0,matrial_type:"",is_delecte:!1,copycontent:"",emptyG:!1,emptyS:!1,disabled:!0,goodsid:this.$route.query.id,imagesshow:"",bigimgshow:[],mobileP:""}},beforeMount:function(){},methods:{wenan:function(){var t=this.express.length;console.log(this.express.length),t>0&&(this.disabled=!1),0==t&&0==this.localArr.length&&(this.disabled=!0),t>200&&(this.disabled=!1,_this.$toast({message:"字数超出200！",position:"center",duration:700}))},bacgroundimg:function(){this.visible=!1},deletesimgs:function(t){this.localArr.splice(t,1),this.imgs.splice(t,1),0==this.localArr.length&&0==this.express.length&&(this.disabled=!0)},preBigImg:function(t){wx.previewImage({current:t,urls:t.image_url})},showImg:function(t){wx.previewImage({current:t,urls:this.localArr})},uploadImg:function(){var t=this;wx.ready(function(){wx.chooseImage({count:1,sizeType:["compressed"],success:function(e){t.$nextTick(function(){var i=e.localIds[0];window.__wxjs_is_wkwebview?wx.getLocalImgData({localId:i,success:function(e){var i=e.localData;i=i.replace("jgp","jpeg"),t.localArr.push(i),t.numPicture=t.localArr.length,(t.localArr.length||t.letterN.length)&&(t.disabled=!1)},fail:function(t){alert("显示失败")}}):(t.localArr.push(i),t.numPicture=t.localArr.length,(t.localArr.length||t.letterN.length)&&(t.disabled=!1)),wx.uploadImage({localId:i,isShowProgressTips:1,success:function(e){var i=e.serverId;console.log("1"+e.serverId),t.imageUpload(i)}})})}})})},imageUpload:function(t){var e=this;e.$axios.post(e.$store.state.api.image_upload,{media_id:t}).then(function(t){var i=t.data;e.imgs.push(i.data)})},postoutPicture:function(){var t=this,e=t.imgs.join();console.log(t.imgs);t.is_public,this.$axios.post(t.$store.state.api.suggestion,{suggest_type:"goods",mobile:t.mobileP,content:t.express,image:e}).then(function(e){var i=e.data;0===i.error&&(t.$toast({message:"提交成功！",position:"center",duration:700}),t.addPicture=!0,t.express="",t.mobileP="",t.localArr=[],t.imgs=[],t.$nextTick(function(){}),setTimeout(function(){t.$router.push("/index")},500)),1===i.error&&t.$toast({message:i.error_msg,position:"center",duration:700})}).catch(function(t){})}}},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"my-schoolbox"},[i("div",{staticClass:"addMyPicture"},[i("div",{staticClass:"mcontents"},[i("div",{staticClass:"wenanTitle"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.express,expression:"express"}],staticStyle:{resize:"none"},attrs:{type:"text",placeholder:"有什么想吃的告诉我们哦 ",maxlength:"200"},domProps:{value:t.express},on:{input:[function(e){e.target.composing||(t.express=e.target.value)},t.wenan]}})]),t._v(" "),i("div",{staticClass:"tips"},[t._v("\n\t\t  \t\t\t上传图片(最多上传4张)\n\t\t  \t\t")]),t._v(" "),i("ul",{staticClass:"addpictrueList"},[t._l(t.localArr,function(e,s){return i("li",{staticStyle:{position:"relative"},on:{click:function(i){t.showImg(e)}}},[i("img",{attrs:{src:e}}),t._v(" "),i("span",{staticStyle:{width:"0.48rem",height:"0.48rem",background:"#C2C2C2","border-radius":"100%","font-size":"0.5rem",color:"#fff","text-align":"center","line-height":"0.48rem",position:"absolute",top:"-0.15rem",right:"-0.15rem"},on:{click:function(e){e.preventDefault(),e.stopPropagation(),t.deletesimgs(s)}}},[i("i",{staticClass:"iconfont icon-quxiao",staticStyle:{"font-size":"0.5rem",color:"#fff"}})])])}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.localArr.length<4,expression:"localArr.length<4"}],staticClass:"upload-img",staticStyle:{width:"1.3rem",height:"1.3rem",float:"left"},on:{click:t.uploadImg}},[i("span"),t._v(" "),i("span")])],2)]),t._v(" "),i("div",{staticClass:"connection"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.mobileP,expression:"mobileP"}],attrs:{placeholder:"请填写手机号，方便我们联系",maxlength:"11"},domProps:{value:t.mobileP},on:{input:function(e){e.target.composing||(t.mobileP=e.target.value)}}})])]),t._v(" "),i("div",{on:{touchmove:function(t){t.preventDefault()}}},[i("mt-popup",{staticClass:"shuoming1",attrs:{"popup-transition":"popup-fade",position:"center"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[i("mt-swipe",{attrs:{auto:0}},t._l(t.bigimgshow,function(e,s){return i("mt-swipe-item",{key:"index",staticStyle:{"margin-right":"0.26rem"}},[i("div",{staticStyle:{position:"relative",width:"100%",height:"100%",background:"#000"},on:{click:t.bacgroundimg}},[i("img",{staticStyle:{width:"100%",position:"absolute",top:"0rem",bottom:"0rem",left:"0rem",right:"0rem",margin:"auto"},attrs:{src:e.image_url}})])])}))],1)],1),t._v(" "),i("mt-button",{class:[t.localArr.length||t.express.length?"button_fabu2 mintbuttons":"button_fabu mintbuttons"],attrs:{disabled:t.disabled},nativeOn:{click:function(e){return t.postoutPicture(e)}}},[t._v("发布")])],1)},staticRenderFns:[]};var a=i("VU/8")(s,o,!1,function(t){i("4rXH")},"data-v-3a3a7f2a",null);e.default=a.exports}});