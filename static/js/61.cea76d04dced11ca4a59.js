webpackJsonp([61],{ICWq:function(t,e){},j6LG:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o={name:"write",data:function(){return{causeList:["商品质量问题","商品与页面描述不符","收到商品破损","商品错发","商品漏发","个人原因退货","我已拒收","未收到货，不想要了"],goodsTitle:"",goodsStandard:"",buyNumber:"1",buyPrice:"",returnsType:"退货退款",returnsNum:"",describe:"",order_sn:"",goods_id:"",spec_key:"",return_status:"1",order_id:"",goodsImg:"",goods_num:"",canAdd:"",imgs:[],bAll:!1,localArr:[],isSend:!1,reName:"",reNum:"",rePrice:"",dialog:!1,unitPrice:"",Coin:"",reCoin:"",popupVisible:!1,reasonPopup:!1,arrLast:"",goodsArr:[],promId:"",returnGiftGoodsId:"",returnGiftSpecKey:"",returnGifiRecid:"",promType:""}},beforeMount:function(){},mounted:function(){sessionStorage.reloads?this.bAll=!0:(sessionStorage.reloads=0,window.location.reload()),this.getInfo(),this.getOrderInfo(),this.onloadAdd()},methods:{showImg:function(t){wx.previewImage({current:t,urls:this.localArr})},showReason:function(){this.reasonPopup=!0},getInfo:function(t,e){var s=this;this.$axios({method:"get",url:s.$store.state.api.order.return_goods,params:{rec_id:s.$route.query.rec_id}}).then(function(t){var e=t.data;0==e.error&&(s.goodsImg=e.data.goods_info.goods_thumbnail_250,s.goodsTitle=e.data.goods_info.goods_name,s.buyNumber=e.data.goods_info.goods_num,s.buyPrice=e.data.goods_info.actual_price_fee.toFixed(2),s.returnsNum=e.data.goods_info.goods_num,s.unitPrice=e.data.goods_info.actual_price,s.Coin=e.data.goods_info.actual_coin_fee),1==e.error&&s.$toast({message:e.error_msg,position:"center",duration:700})}).catch(function(t){})},getOrderInfo:function(){var t=this;t.$axios({method:"get",url:t.$store.state.api.order.get_order_info,params:{order_sn:t.$route.query.order_sn,order_type:"normal"}}).then(function(e){var s=e.data;if(0==s.error){t.promType=s.data.prom_type,t.arrLast=s.data.goods_list[s.data.goods_list.length-1],t.goodsArr=s.data.goods_list,console.log(t.arrLast,"res");for(var o=0;o<t.goodsArr.length;o++)t.goodsArr[o].goods_id==t.$route.query.goods_id&&(console.log(o,"which"),t.promId=t.goodsArr[o].prom_id),t.goodsArr[o].prom_id==t.promId&&1==t.goodsArr[o].is_gift&&(console.log(o,"gift"),t.returnGiftGoodsId=t.goodsArr[o].goods_id,t.returnGiftSpecKey=t.goodsArr[o].spec_key,t.returnGifiRecid=t.goodsArr[o].rec_id)}})},subtract:function(){this.returnsNum--,this.returnsNum<=1&&(this.returnsNum=1)},add:function(){this.returnsNum++,this.returnsNum==this.goods_num-1?this.canAdd=!0:this.canAdd=!1},onloadAdd:function(){1==this.goods_num?this.canAdd=!0:this.canAdd=!1},uploadImg:function(){var t=this;wx.ready(function(){wx.chooseImage({count:1,success:function(e){t.$nextTick(function(){var s=e.localIds[0];window.__wxjs_is_wkwebview?wx.getLocalImgData({localId:s,success:function(e){var s=e.localData;s=s.replace("jgp","jpeg"),t.localArr.push(s)},fail:function(t){alert("显示失败")}}):t.localArr.push(s),wx.uploadImage({localId:s,isShowProgressTips:1,success:function(e){var s=e.serverId;t.imageUpload(s)}})})}})})},imageUpload:function(t){var e=this;e.$axios.post(e.$store.state.api.image_upload,{media_id:t}).then(function(t){var s=t.data;e.imgs.push(s.data)})},showPopup:function(){this.dialog=!0,this.reName=this.goodsTitle,this.rePrice=this.accMul(this.unitPrice,this.returnsNum).toFixed(2),this.reCoin=this.accMul(this.Coin/this.buyNumber,this.returnsNum)},check:function(){var t=this;"mjs"==t.promType&&"1"==t.arrLast.is_gift?t.$axios({method:"get",url:t.$store.state.api.order.check_return_prom,params:{order_id:t.$route.query.order_id,goods_id:t.$route.query.goods_id,spec_key:t.$route.query.spec_key,return_num:t.returnsNum}}).then(function(e){var s=e.data;0==s.error&&t.submit(),1==s.error&&(t.popupVisible=!0)}):t.submit()},submit:function(){var t=this;t.isSend=!0;var e=t.imgs.join(),s=document.getElementById("text").value;this.$axios({url:t.$store.state.api.order.submit_return,method:"post",params:{rec_id:t.$route.query.rec_id,num:t.returnsNum,reason:s,comment:t.describe,image_no:e}}).then(function(e){var s=e.data;0==s.error&&(t.$router.push({path:"/applyinfo",query:{order_sn:t.$route.query.order_sn,goods_id:t.$route.query.goods_id,spec_key:t.$route.query.spec_key,return_status:1,order_id:t.$route.query.order_id,rec_id:t.$route.query.rec_id}}),sessionStorage.removeItem("reloads"),t.$toast({message:"退货申请已提交",position:"center",duration:700})),1==s.error&&t.$toast({message:s.error_msg,position:"center",duration:700})}).catch(function(t){}),setTimeout(function(){t.isSend=!1},3e3)},submitGift:function(){var t=this;t.isSend=!0;var e=t.imgs.join(),s=document.getElementById("text").value;t.$axios({url:t.$store.state.api.order.submit_return,method:"post",params:{rec_id:t.$route.query.rec_id,num:t.returnsNum,reason:s,comment:t.describe,image_no:e}}).then(function(e){0==e.data.error&&t.$axios({url:t.$store.state.api.order.submit_return,method:"post",params:{rec_id:t.returnGifiRecid,num:"1",reason:"不满足赠品条件",comment:"剩余商品不满足满赠条件"}}).then(function(e){var s=e.data;0==s.error&&(t.$router.push({path:"/applyinfo",query:{order_sn:t.$route.query.order_sn,goods_id:t.$route.query.goods_id,spec_key:t.$route.query.spec_key,return_status:1,order_id:t.$route.query.order_id,rec_id:t.$route.query.rec_id}}),sessionStorage.removeItem("reloads"),t.$toast({message:"退货申请已提交",position:"center",duration:700})),1==s.error&&t.$toast({message:s.error_msg,position:"center",duration:700})})}),setTimeout(function(){t.isSend=!1},3e3)},accMul:function(t,e){var s=0,o=t.toString(),r=e.toString();try{s+=o.split(".")[1].length}catch(t){}try{s+=r.split(".")[1].length}catch(t){}return Number(o.replace(".",""))*Number(r.replace(".",""))/Math.pow(10,s)},closePopup:function(){this.dialog=!1}}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.bAll?s("div",{staticClass:"write  wd-font-pfsc30"},[s("div",{staticClass:"goods-info"},[s("img",{attrs:{src:t.goodsImg}}),t._v(" "),s("div",{staticClass:"goods-info-right"},[s("p",{staticClass:"goods-title"},[t._v(t._s(t.goodsTitle))]),t._v(" "),s("p",{staticClass:"goods-standard"},[t._v(t._s(t.goodsStandard))]),t._v(" "),s("p",{staticClass:"buy"},[s("span",{staticClass:"buy-price"},[t._v("实付金额: "),s("b",[t._v("￥")]),s("b",[t._v(t._s(t.buyPrice))])]),t._v(" "),s("span",{staticClass:"buy-number"},[t._v("x"+t._s(t.buyNumber))])])])]),t._v(" "),s("div",{staticClass:"reason"},[s("p",{staticClass:"returns-type"},[s("label",[t._v("退货类型：")]),t._v(" "),s("span",[t._v(t._s(t.returnsType))])]),t._v(" "),s("div",{staticClass:"returns-num"},[s("label",[t._v("退货数量：")]),t._v(" "),s("div",[s("button",{staticClass:"subtract",attrs:{type:"default"},on:{click:t.subtract}},[t._v("-")]),t._v(" "),s("span",[t._v(t._s(t.returnsNum))]),t._v(" "),s("button",{staticClass:"add",attrs:{type:"default",disabled:t.returnsNum>=t.buyNumber},on:{click:t.add}},[t._v("+")])])]),t._v(" "),s("div",{staticClass:"returns-cause"},[s("span",[t._v("*")]),t._v(" "),s("label",[t._v("退货原因：")]),t._v(" "),s("div",{on:{click:function(e){t.showReason()}}},[t._v("请选择退款原因"),s("i",{staticClass:"iconfont icon-zuoyou-copy-copy"})])]),t._v(" "),s("div",{staticClass:"describe"},[t._m(0),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.describe,expression:"describe"}],attrs:{placeholder:"请详细的描述"},domProps:{value:t.describe},on:{input:function(e){e.target.composing||(t.describe=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"upload"},[t._m(1),t._v(" "),s("div",{staticClass:"ceshi"},t._l(t.localArr,function(e,o){return s("img",{key:"index",staticStyle:{width:"1.6rem",height:"1.6rem",float:"left","margin-right":"0.2rem"},attrs:{src:e},on:{click:function(s){t.showImg(e)}}})})),t._v(" "),t.localArr.length<3?s("div",{staticClass:"upload-img",on:{touchstart:t.uploadImg}},[s("i",{staticClass:"iconfont"},[t._v("")])]):t._e()]),t._v(" "),t._m(2)]),t._v(" "),s("button",{staticClass:"submit",on:{click:t.showPoReason}},[t._v("提交售后申请")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.dialog,expression:"dialog"}],staticClass:"dialog"},[s("div",{staticClass:"popup-content"},[s("h4",[t._v("退款信息确认")]),t._v(" "),s("div",[s("span",[t._v("退款商品：")]),t._v(" "),s("p",[t._v(t._s(t.reName))])]),t._v(" "),s("div",[s("span",[t._v("退款商品数：")]),t._v(" "),s("span",[t._v(t._s(t.returnsNum)+"件")])]),t._v(" "),s("div",[s("span",[t._v("最高退款金额：")]),t._v(" "),s("span",[t._v("￥ "+t._s(t.rePrice))])]),t._v(" "),s("div",[s("span",[t._v("退还厨币数：")]),t._v(" "),s("span",[t._v(t._s(t.reCoin))])]),t._v(" "),s("button",{attrs:{disabled:t.isSend},on:{click:function(e){t.check()}}},[t._v("确定退款")]),t._v(" "),s("div",{on:{click:function(e){t.closePopup()}}},[t._v("取消")])])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.popupVisible,expression:"popupVisible"}],staticClass:"popup-visible"},[s("div",{staticClass:"content"},[s("p",[t._v("退货之后赠品将不满足赠品条件，赠品会一起退货，确定继续退货吗？")]),t._v(" "),s("div",[s("button",{on:{click:function(e){t.popupVisible=!1}}},[t._v("取消")]),t._v(" "),s("button",{on:{click:function(e){t.submitGift()}}},[t._v("继续")])])])]),t._v(" "),s("mt-popup",{staticClass:"reason-select",attrs:{position:"bottom",closeOnClickModal:""},model:{value:t.reasonPopup,callback:function(e){t.reasonPopup=e},expression:"reasonPopup"}},[s("div",{staticClass:"select-handle"},[s("span",{staticClass:"wd-font-pfsc32"},[t._v("选择退款原因")]),t._v(" "),s("i",{staticClass:"iconfont",on:{click:function(e){t.closePopup()}}},[t._v("")])]),t._v(" "),s("div",{staticClass:"select-content"},[s("mt-picker",{staticClass:"picker1",attrs:{slots:t.causeList},on:{change:t.selectReason}})],1)])],1):t._e()},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("span",[this._v("*")]),e("label",[this._v("问题描述：")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("label",[this._v("上传凭证（最多三张）：")]),e("span",[this._v("*")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"declare"},[e("p",[e("label",[this._v("退货申明")]),e("span",[this._v("*")])]),this._v(" "),e("div",[this._v("    自确认收货起的7天内，在商品完好未开封使用以及包装附件完整、且来回退换货运费由消费者承担等情况下，可享受7天无理由退换货服务。"),e("br"),this._v("\n特殊商品：鉴于生鲜农产品（蔬菜水果、水产海鲜、肉禽蛋类等）的特殊性和往返物流的高损耗，所售生鲜农产品非质量问题，恕不退还，若质量有问题请在收到货的2小时内联系安厨客服，并提供相关凭证。\n")])])}]};var i=s("VU/8")(o,r,!1,function(t){s("ICWq")},"data-v-64490a5a",null);e.default=i.exports}});